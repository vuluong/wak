function getRootLocalWindow(){for(var e=window,t=0;t<5;t++)try{if(null==e.parent)break;isSameOrigin(e,e.parent)&&(e=e.parent)}catch(e){break}return e}function isSameOrigin(e,t){try{return t.location.host==e.location.host}catch(e){return!1}}function openDialog(e,t,n){var o=getRootLocalWindow();e+=(0<=e.indexOf("?")?"&":"?")+"features=popup";var i=document.createElement("iframe"),r=o.innerWidth-20,a=o.innerHeight-40;r<t&&(t=r),a<n&&(n=a),i.width=t,i.height=n,i.src=e,(i.parentWindow=o).$.msgBox({type:"dialog",htmlContent:i})}function loadContent(t,e){$.ajax({url:e,success:function(e){$("#"+t).html(e)}})}function updateFieldValue(e,t){var n=document.getElementById(e);n&&(n.value=t)}function updateFieldChecked(e,t){var n=document.getElementById(e);n&&(n.checked=t)}function moveUpTR(e){"TR"!=e.tagName&&(e=e.parentNode),prevTr=e.previousSibling,null!=prevTr&&"TR"==prevTr.tagName&&(table=e.parentNode,"TABLE"!=table.tagName&&(table=table.parentNode),prevTr.parentNode.insertBefore(e,prevTr),formChanged=!0)}function moveDownTR(e){"TR"!=e.tagName&&(e=e.parentNode),nextTr=e.nextSibling,null!=nextTr&&"TR"==nextTr.tagName&&(table=e.parentNode,"TABLE"!=table.tagName&&(table=table.parentNode),e.parentNode.insertBefore(nextTr,e),formChanged=!0)}function getBrowserName(){var e="",t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("opera")?e="opera":-1!=t.indexOf("msie")?e="msie":-1!=t.indexOf("safari")?e="safari":-1!=t.indexOf("mozilla")&&(e=-1!=t.indexOf("firefox")?"firefox":"mozilla"),e}function get_top_level_node(e){for(var t=e;null!=t.parentNode;)t=t.parentNode;return t}function lpad(e,t,n){var o=e.toString();for(i=e.length+1;i<=t;i++)o=n+o;return o}function rpad(e,t,n){var o=e.toString();for(i=e.length+1;i<=t;i++)o+=n;return o}function getViewportTop(){return document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop}function getViewportLeft(){return document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft}function getViewportHeight(){var e=window.innerHeight,t=document.compatMode;return!t&&$.support.boxModel||(e="CSS1Compat"==t?document.documentElement.clientHeight:document.body.clientHeight),e}function getViewportWidth(){var e=window.innerWidth,t=document.compatMode;return!t&&$.support.boxModel||(e="CSS1Compat"==t?document.documentElement.clientWidth:document.body.clientWidth),e}function getElementTop(e){for(var t=e.offsetTop;e.offsetParent;)t+=(e=e.offsetParent).offsetTop;return t}function getElementLeft(e){for(var t=e.offsetLeft;e.offsetParent;)t+=(e=e.offsetParent).offsetLeft;return t}function scroll_to(e){var t=getElementLeft(e),n=getViewportLeft(),o=getElementTop(e),i=getViewportTop(),r=getViewportWidth(),a=getViewportHeight(),l=n,c=i;(o<i||i+a<o)&&(c=o-25),(t<n||n+r<t)&&(l=t-25),l==n&&c==i||window.scrollTo(l,c)}function applyTreeNode(e){$('a[id^="'+e+'"]').each(function(){initializeTreeNodeVisibility(this.getAttribute("id"))}),$('a[id^="'+e+'"]').click(function(){toggleTreeNodeVisibility(this.getAttribute("id"))})}function initializeTreeNodeVisibility(e){var t=$('[id="'+e+'"]');if(0==$('[id^="'+e+'_"]').length)t.addClass("tree_node_leaf");else{var n=null;try{n=localStorage["treeNode."+e+".hide"]}catch(e){}"1"==n?toggleTreeNodeVisibility(e,!0):t.addClass("tree_node_expanded")}}function toggleTreeNodeVisibility(e,t){var n=$('[id="'+e+'"]'),o=$('[id^="'+e+'_"]').parent();if(0<o.length)if("td"!=o[0].nodeName.toLowerCase()&&(o=o.parent()),null!=t&&1==t||o.parent().is(":visible")){o.parent().hide(),n.removeClass("tree_node_expanded"),n.addClass("tree_node_collapsed");try{localStorage["treeNode."+e+".hide"]="1"}catch(e){}}else{o.parent().show(),n.removeClass("tree_node_collapsed"),n.addClass("tree_node_expanded");try{localStorage["treeNode."+e+".hide"]="0"}catch(e){}}else n.removeClass("tree_node_expanded"),n.removeClass("tree_node_collapsed"),n.addClass("tree_node_leaf")}function initializeModuleVisibility(e){var t=null;try{t=localStorage["module."+e+".hide"]}catch(e){}"1"==t&&toggleModuleVisibility(e)}function toggleModuleVisibility(e){if(toggleCanvasVisibility(document.getElementById(e),document.getElementById(e+"ToggleButton")))try{localStorage["module."+e+".hide"]="0"}catch(e){}else try{localStorage["module."+e+".hide"]="1"}catch(e){}}function hideCanvas(e,t){e.style.display="none",t.src=t.src.substring(0,t.src.lastIndexOf("/"))+"/icon_maximize.png"}function showCanvas(e,t){e.style.display="block",t.src=t.src.substring(0,t.src.lastIndexOf("/"))+"/icon_minimize.png"}function toggleCanvasVisibility(e,t){return"none"==e.style.display?(showCanvas(e,t),!0):(hideCanvas(e,t),!1)}function addOption(e,t,n){var o=document.createElement("OPTION");o.text=t,o.value=n,e.options.add(o)}function removeAllOptions(e){for(var t=e.options.length-1;0<=t;t--)e.remove(t)}function updateAllFieldValueByIds(e,t){for(i=0;i<e.length;i++)field=document.getElementById(e[i]),field.value=t}function updateAllFieldValue(e,t,n){if(e)if(e.type)null!=n&&""!=n&&n==e.value||(e.value=t);else for(i=0;i<e.length;i+=1)null!=n&&""!=n&&n==e[i].value||(e[i].value=t)}function updateAllComboBox(e,t,n,o){if(null!=t&&""!=t){var r=e.getElementsByTagName("select");for(i=0;i<r.length;i+=1){0==r[i].id.indexOf(t)&&(null!=o&&""!=o&&o==r[i].value||(r[i].value=n))}}}function updateAllCheckBox(e,t){if(e)if(t instanceof Array){if(e.type){for(j=0;j<t.length;j+=1)if(e.value==t[j]){e.checked=!0;break}}else for(i=0;i<e.length;i+=1)for(j=0;j<t.length;j+=1)if(e[i].value==t[j]){e[i].checked=!0;break}}else if(e.type)e.checked=t;else for(i=0;i<e.length;i+=1)e[i].checked=t}function updateAllCheckBoxEx(e,t,n){if(e)for(var o=$(e).find("input:checkbox"),i=0;i<o.length;i++){var r=o[i];0==r.id.indexOf("chk_"+t)&&(updateFieldChecked(r.id,n),$("#"+r.id.substring(4)).val(n))}}function atLeastOneCheckBoxChecked(e){if(e){if(e.type)return e.checked;for(i=0;i<e.length;i+=1)if(e[i].checked)return!0}return!1}function atLeastOneCheckBoxUnchecked(e){if(e){if(e.type)return!e.checked;for(i=0;i<e.length;i+=1)if(!e[i].checked)return!0}return!1}function changeChildCombo(e,t,n){for(var o,i="Microsoft Internet Explorer"==navigator.appName?-1:null,r=e.form.elements[t],a=e.form.elements[n];r.options.length;)r.remove(0);for(var l=0;l<a.options.length;l++)for(var c=0;c<e.options.length;c++)if(1==e.options[c].selected){var d=e.options[c].value+"_";0==a.options[l].value.indexOf(d)&&((o=document.createElement("option")).text=a.options[l].text,o.value=a.options[l].value.substr(d.length),r.add(o,i))}}function removeTableRow(e,t){document.getElementById(e).deleteRow(t.rowIndex),formChanged=!0}function applyCurrencyEditor(e){var t=document.getElementById(e);t.onblur=function(){this.value=formatCurrency(this.value)},t.value=formatCurrency(t.value)}function formatCurrency(e){return formatNumber(e,1,!0)}function extractSimpleNumber(e){e=trim(e.toString());for(var t="",n=!1,o=0;o<e.length;++o){var i=e.charAt(o);0==o&&"-"==i&&(n=!0),0<="0123456789.".indexOf(i)&&(t+=i)}return n&&(t="-"+t),t}function formatNumber(e,t,n){e=trim(e.toString());for(var o="",i=!1,r=0;r<e.length;++r){var a=e.charAt(r);0==r&&"-"==a&&(i=!0),0<="0123456789.".indexOf(a)&&(o+=a)}if(""==o)return"";var l,c,d=o.indexOf(".");for(0<=d?(l=o.substring(0,d),c=o.substring(d+1)):l=o;1<l.length&&"0"==l.charAt(0);)l=l.substring(1);l=parseInt(l),isNaN(l)&&(l=0),null==n&&(n=!1),0==t&&(t=1);var u="";for(r=0;r<t||0<l;++r)n&&u.match(/^\d\d\d/)&&(u=","+u),u=l%10+u,l=Math.floor(l/10);return c&&(""!=c&&(c=c.replace(/\./g,"")),""!=c&&(u+="."+c.toString())),i&&(u="-"+u),u}function applyCodeEditor(e){var t=document.getElementById(e);t.onblur=function(){this.value=formatCode(this.value)},t.value=formatCode(t.value)}function formatCode(e){e=trim(e.toString());for(var t="",n=0;n<e.length;++n){var o=e.charAt(n);" "<o&&(t+=o)}return t}function trim(e,t){return ltrim(rtrim(e,t),t)}function ltrim(e,t){return t=t||"\\s",e.replace(new RegExp("^["+t+"]+","g"),"")}function rtrim(e,t){return t=t||"\\s",e.replace(new RegExp("["+t+"]+$","g"),"")}function escapeHtml(e){return null==e?e:e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;").split("'").join("&apos;").split('"').join("&quot;")}function escapeJavaScript(e){return null==e?e:e.split('"').join('\\"').split("'").join("\\'")}function stripUserContent(e){return null!=e&&(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/<br>/gi,"\n")).replace(/<p.*>/gi,"\n")).replace(/<a.*?href=[\"\']?([^\"\']*)[\"\']?.*?>([^<]*)<\/a>/gi,":{a href='$1':}$2:{/a:}")).replace(/<img.*?src=[\"\']?([^\"\']*)[\"\']?.*?\/?>/gi,":{img src='$1' /:}")).replace(/<script([^>]*)>([^<]*)<\/script>/gi,"")).replace(/javascript/gi,"")).replace(/:{/g,"<")).replace(/:}/g,">")),e}function disableEnterKey(e){return 13!=(window.event?window.event.keyCode:e.which)}function sendPost(e,t,n){var o=document.createElement("form");for(var i in o.action=e,o.method="POST",null!=n&&""!=n&&(o.target=n),t)if(t.hasOwnProperty(i)){var r=document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name",i),r.setAttribute("value",t[i]),o.appendChild(r)}document.body.appendChild(o),o.submit(),document.body.removeChild(o)}window.tableToExcel=function(e,t,n){null==n&&(n="table tr th {mso-number-format:\\@;}");var o='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<meta http-equiv="content-type" content="text/plain; charset=UTF-8"/><style>'+n+"</style></head><body>{table}</body></html>",i=function(e,n){return e.replace(/{(\w+)}/g,function(e,t){return n[t]})};e.nodeType&&(e="<table>"+e.innerHTML+"</table>");var r={worksheet:t||"Worksheet",table:e=e.replace(/<\/?a [^>]+(>|$)/g,"")},a=window.navigator.userAgent;if(0<a.indexOf("Edge/")||0<a.indexOf("MSIE ")||navigator.userAgent.match(/Trident.*rv\:11\./)){if(window.navigator.msSaveBlob){var l=new Blob([i(o,r)],{type:"application/vnd.ms-excel;charset=utf-8;"});navigator.msSaveBlob(l,t+".xls")}}else{l=new Blob([i(o,r)],{type:"application/vnd.ms-excel"});var c=$("<a download='"+t+"'>"+t+"<span></span></a>");c.attr("href",(window.URL||window.webkitURL).createObjectURL(l)),c.appendTo(document.body),c.find("span").trigger("click").parent().remove()}},window.urlToExcel=function(e,t,n){$.ajax({url:e,success:function(e){window.tableToExcel(e,t,n)}})};